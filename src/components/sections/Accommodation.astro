---
import images from "../../cms-content/images.json";

interface Props {
  t: any;
  locale: string;
}
const { t, locale } = Astro.props as Props;

type GalleryImage = {
  image: string;
  mobileTitle?: {
    fr?: string;
    en?: string;
  };
};

type PhotoGroup = {
  images: (string | GalleryImage)[];
  legend: {
    fr: string;
    en: string;
  };
};

const isImageObject = (
  img: string | GalleryImage
): img is GalleryImage => typeof img === "object" && img !== null && "image" in img;

const accommodationGroups = images.accommodation.photo_groups as PhotoGroup[];
---

<!-- Simplified Accommodation Section -->
<section id="accommodation" class="relative py-16 md:py-20 bg-white">
  <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center mb-16 animate-on-scroll">
      <h2
        class="text-3xl lg:text-4xl font-serif font-bold text-forest-800"
      >
        {t.accommodation.title}
      </h2>
    </div>

    <!-- Photo Gallery with Legends -->
    <div class="mb-20 animate-on-scroll">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {
          accommodationGroups.map((group, index) => (
            <div
              class={
                group.images.length > 1 || index === accommodationGroups.length - 1
                  ? "md:col-span-2"
                  : "md:col-span-1"
              }
            >
              {group.images.length > 1 ? (
                <div class="mb-8">
                  <!-- Multi-image group -->
                  <div
                    class={`grid gap-4 items-end ${
                      group.images.length === 2
                        ? "grid-cols-1 md:grid-cols-2"
                        : "grid-cols-1 md:grid-cols-3"
                    }`}
                  >
                    {group.images.map((image) => (
                      <div class="flex flex-col items-center">
                        <div class="flex justify-center items-end w-full">
                          <img
                            src={isImageObject(image) ? image.image : image}
                            alt={locale === "fr" ? group.legend.fr : group.legend.en}
                            class="rounded-xl shadow-soft w-full h-auto max-h-[500px] object-cover object-center"
                            style="aspect-ratio: auto;"
                            loading="lazy"
                          />
                        </div>
                        <p class="text-center text-forest-700 font-medium mt-4 text-base md:text-lg md:hidden">
                          {isImageObject(image) && image.mobileTitle
                            ? locale === "fr"
                              ? image.mobileTitle.fr
                              : image.mobileTitle.en
                            : locale === "fr"
                              ? group.legend.fr
                              : group.legend.en}
                        </p>
                      </div>
                    ))}
                  </div>
                  <p class="text-center text-forest-700 font-medium mt-4 text-base md:text-lg hidden md:block">
                    {locale === "fr" ? group.legend.fr : group.legend.en}
                  </p>
                </div>
              ) : (
                <div class="mb-8 flex flex-col items-center">
                  <!-- Single image -->
                  <div class="flex justify-center items-end">
                    <img
                      src={isImageObject(group.images[0]) ? group.images[0].image : group.images[0]}
                      alt={locale === "fr" ? group.legend.fr : group.legend.en}
                      class="rounded-xl shadow-soft w-full h-auto max-h-[500px] object-cover object-center"
                      style="aspect-ratio: auto;"
                    />
                  </div>
                  <p class="text-center text-forest-700 font-medium mt-4 text-base md:text-lg md:hidden">
                    {isImageObject(group.images[0]) && group.images[0].mobileTitle
                      ? locale === "fr"
                        ? group.images[0].mobileTitle.fr
                        : group.images[0].mobileTitle.en
                      : locale === "fr"
                        ? group.legend.fr
                        : group.legend.en}
                  </p>
                  <p class="text-center text-forest-700 font-medium mt-4 text-base md:text-lg hidden md:block">
                    {locale === "fr" ? group.legend.fr : group.legend.en}
                  </p>
                </div>
              )}
            </div>
          ))
        }
      </div>
    </div>

    <!-- Ecological Construction Section -->
    <div class="grid lg:grid-cols-2 gap-8 mb-16 animate-on-scroll">
      <div class="bg-gradient-to-br from-sage-50 to-warm-50 rounded-xl p-8">
        <h3 class="text-2xl font-serif font-semibold text-forest-800 mb-6">
          {t.accommodation.ecological_construction_title}
        </h3>
        <div class="space-y-4 text-forest-700">
          <p>
            {t.accommodation.ecological_construction_intro}
          </p>
          <p>
            {t.accommodation.ecological_construction_insulation}
          </p>
          <p>
            {t.accommodation.ecological_construction_water}
          </p>
        </div>
        <div class="grid grid-cols-1 gap-3 mt-6">
          <div class="flex items-center space-x-2">
            <span class="text-sage-600">‚úì</span>
            <span class="text-sm">{t.accommodation.water_filter}</span>
          </div>
          <div class="flex items-center space-x-2">
            <span class="text-sage-600">‚úì</span>
            <span class="text-sm">{t.accommodation.led_lighting}</span>
          </div>
          <div class="flex items-center space-x-2">
            <span class="text-sage-600">‚úì</span>
            <span class="text-sm">{t.accommodation.solar_panels}</span>
          </div>
          <div class="flex items-center space-x-2">
            <span class="text-sage-600">‚úì</span>
            <span class="text-sm">{t.accommodation.organic_products}</span>
          </div>
          <div class="flex items-center space-x-2">
            <span class="text-sage-600">‚úì</span>
            <span class="text-sm">{t.accommodation.composter}</span>
          </div>
        </div>
        <div class="mt-6 p-4 bg-white/50 rounded-lg border border-sage-200">
          <div class="flex items-start space-x-2">
            <span class="text-xl">üåø</span>
            <p class="text-forest-700 text-sm">
              {t.accommodation.phyto_message}
            </p>
          </div>
        </div>
      </div>

      <div>
        <img
          src="/images/accommodation-extracted/media/image15.webp"
          alt={t.accommodation.ecological_construction_alt}
          class="w-full h-full object-cover rounded-xl"
        />
      </div>
    </div>

    <!-- Practical Information Grid -->
    <div class="grid md:grid-cols-2 gap-6 mb-12 animate-on-scroll">
      <!-- Check-in/out -->
      <div class="bg-sage-50 rounded-xl p-6">
        <h3 class="font-semibold text-lg text-forest-800 mb-4 flex items-center">
          <span class="text-2xl mr-2">üïê</span>
          {t.accommodation.schedule}
        </h3>
        <div class="space-y-3 text-forest-700">
          <div>
            <div class="font-semibold">{t.accommodation.checkin}</div>
            <div>17h00 - 21h00</div>
          </div>
          <div>
            <div class="font-semibold">{t.accommodation.checkout}</div>
            <div>08h00 - 10h00</div>
          </div>
        </div>
      </div>

      <!-- House Rules -->
      <div class="bg-warm-50 rounded-xl p-6">
        <h3 class="font-semibold text-lg text-forest-800 mb-4 flex items-center">
          <span class="text-2xl mr-2">üìã</span>
          {t.accommodation.house_rules}
        </h3>
        <div class="space-y-3 text-forest-700">
          <div class="flex items-center space-x-2">
            <span>üö≠</span>
            <span set:html={t.accommodation.non_smoking} />
          </div>
          <div class="flex items-center space-x-2">
            <span>üêæ</span>
            <span set:html={t.accommodation.no_pets} />
          </div>
          <div class="flex items-center space-x-2">
            <span>üéâ</span>
            <span set:html={t.accommodation.no_parties} />
          </div>
        </div>
      </div>
    </div>

    <!-- Important Information Section - Centered Side by Side -->
    <div class="flex justify-center mb-8">
      <div class="grid md:grid-cols-2 gap-6 max-w-5xl">
        <!-- Accessibility -->
        <div
          class="bg-gradient-to-br from-amber-100 to-orange-50 rounded-xl p-6 border-2 border-amber-400 shadow-lg"
        >
          <div class="flex items-center space-x-3 mb-4">
            <div
              class="w-12 h-12 bg-white rounded-xl flex items-center justify-center flex-shrink-0 shadow-md"
            >
              <span class="text-2xl">‚ôø</span>
            </div>
            <h3 class="font-semibold text-lg text-amber-900">
              {t.accommodation.accessibility_title}
            </h3>
          </div>
          <p
            class="text-amber-900 text-base leading-relaxed font-medium"
            set:html={t.accommodation.accessibility_message}
          />
        </div>

        <!-- About Our Ducks -->
        <div
          class="bg-gradient-to-br from-amber-100 to-orange-50 rounded-xl p-6 border-2 border-amber-400 shadow-lg"
        >
          <div class="flex items-center space-x-3 mb-4">
            <div
              class="w-12 h-12 bg-white rounded-xl flex items-center justify-center flex-shrink-0 shadow-md"
            >
              <span class="text-2xl">ü¶Ü</span>
            </div>
            <h3 class="font-semibold text-lg text-amber-900">
              {t.accommodation.ducks_title}
            </h3>
          </div>
          <p
            class="text-amber-900 text-base leading-relaxed font-medium"
            set:html={t.accommodation.ducks_message}
          />
        </div>
      </div>
    </div>

    <!-- Host Proximity Note -->
    <div
      class="mx-auto max-w-2xl bg-gradient-to-r from-sage-50 to-blue-50 rounded-xl p-6 border border-sage-200 mb-8 animate-on-scroll"
    >
      <div class="flex items-start space-x-4">
        <span class="text-3xl">üè°</span>
        <div>
          <h4 class="font-semibold text-forest-800 mb-2">
            {t.accommodation.host_proximity_title}
          </h4>
          <p class="text-forest-700 text-sm leading-relaxed">
            {t.accommodation.host_proximity_message}
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
